<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>使用hexo+fluid搭建博客</title>
    <link href="/2021/04/27/%E4%BD%BF%E7%94%A8hexo-fluid%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"/>
    <url>/2021/04/27/%E4%BD%BF%E7%94%A8hexo-fluid%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>如何使用Hexo+Fluid+Github Action搭建博客</p>          </div><span id="more"></span><h2 id="搭建Hexo"><a href="#搭建Hexo" class="headerlink" title="搭建Hexo"></a>搭建Hexo</h2><p>因为Hexo是基于NodeJs的，所以电脑只要安装了NodeJs，就可以直接安装使用Hexo了，<a href="http://nodejs.cn/download/">NodeJs安装地址</a>。因为搭建的是Github pages，所以还需要Git，<a href="https://git-scm.com/downloads">Git安装地址</a></p><p>我使用的NodeJs为<strong>12.16.3</strong>，hexo版本为<strong>5.4.0</strong>，系统是<strong>Window</strong></p><h3 id="1-安装Hexo"><a href="#1-安装Hexo" class="headerlink" title="1.安装Hexo"></a>1.安装Hexo</h3><p>使用<code>npm i -g hexo-cli</code>安装，如果需要指定版本可以：<code>hexo-cli@版本号</code></p><h3 id="2-搭建Fluid主题网站"><a href="#2-搭建Fluid主题网站" class="headerlink" title="2.搭建Fluid主题网站"></a>2.搭建Fluid主题网站</h3><h4 id="1-hexo初始化"><a href="#1-hexo初始化" class="headerlink" title="1.hexo初始化"></a>1.hexo初始化</h4><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 初始化hexo项目,&lt;folder> = 创建的项目的根目录，根据自己的想法命名</span>hexo init <span class="token operator">&lt;</span>folder<span class="token operator">></span><span class="token builtin class-name">cd</span> <span class="token operator">&lt;</span>folder<span class="token operator">></span><span class="token function">npm</span> i<span class="token comment">#安装fluid主题，推荐hexo>5.0</span><span class="token function">npm</span> <span class="token function">install</span> --save hexo-theme-fluid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>这时候根目录下有<code>_config.yml(博客配置)</code>和<code>_config.fluid.yml(主题配置)</code>2个配置文件，如果没有<code>_config.fluid.yml</code>文件，手动在根目录下创建一个。因为我们使用的是<strong>npm直接安装的Fluid主题</strong>,所以不需要在themes下包括fluid的配置文件。之后和主题有关的配置都在<code>config.fluid.yml</code>中配置</p><p>这时候安装了Fluid主题还不能直接用，需要在<code>_config.yml</code>配置一些信息</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">theme</span><span class="token punctuation">:</span> fluid  <span class="token comment"># 指定主题，执行hexi init的时候可能携带了默认主题，替换成这个就行了</span><span class="token key atrule">language</span><span class="token punctuation">:</span> zh<span class="token punctuation">-</span>CN  <span class="token comment"># 指定语言，会影响主题显示的语言，按需修改</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h4 id="2-创建关于页"><a href="#2-创建关于页" class="headerlink" title="2.创建关于页"></a>2.创建关于页</h4><p>因为首次搭建，关于页是需要自己创建的</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">hexo new page about<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>创建完成后会生成<code>/source/about/index.md</code>,这就是关于页面了，可以编写你自己的关于界面</p><p>还可以在<code>_config.fluid.yml</code>中编写about页面相关的配置</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">about</span><span class="token punctuation">:</span>  <span class="token key atrule">banner_img</span><span class="token punctuation">:</span> /img/about.png <span class="token comment">#关于页面的顶部图片</span>  <span class="token key atrule">avatar</span><span class="token punctuation">:</span> /img/avatar.jpg <span class="token comment">#需要显示的自己头像</span>  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"QiongXing"</span> <span class="token comment">#名称</span>  <span class="token key atrule">intro</span><span class="token punctuation">:</span> <span class="token string">"彰显逼格的话"</span>  <span class="token key atrule">icons</span><span class="token punctuation">:</span> <span class="token comment">#自己的相关链接</span>    <span class="token punctuation">-</span> <span class="token punctuation">&#123;</span>        <span class="token key atrule">class</span><span class="token punctuation">:</span> <span class="token string">"iconfont icon-github-fill"</span><span class="token punctuation">,</span>        <span class="token key atrule">link</span><span class="token punctuation">:</span> <span class="token string">"https://github.com/qiongxing"</span><span class="token punctuation">,</span>        <span class="token key atrule">tip</span><span class="token punctuation">:</span> <span class="token string">"GitHub"</span><span class="token punctuation">,</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">-</span> <span class="token punctuation">&#123;</span> <span class="token key atrule">class</span><span class="token punctuation">:</span> <span class="token string">"iconfont icon-qq-fill"</span><span class="token punctuation">,</span> <span class="token key atrule">qrcode</span><span class="token punctuation">:</span> <span class="token string">"/img/qq.png"</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="3-其他主题配置"><a href="#3-其他主题配置" class="headerlink" title="3.其他主题配置"></a>3.其他主题配置</h4><p>因为搭建的Fluid会在归档，文章，分类，标签的页面都使用自带的默认图片，所以都需要自己修改主题配置，<code>banner_img</code>是每个页面默认顶部的配置图片</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#首页</span><span class="token key atrule">index</span><span class="token punctuation">:</span>  <span class="token comment">#顶部图片</span>  <span class="token key atrule">banner_img</span><span class="token punctuation">:</span> /img/home.png<span class="token comment">#文章配置</span><span class="token key atrule">post</span><span class="token punctuation">:</span>  <span class="token key atrule">banner_img</span><span class="token punctuation">:</span> /img/home.png <span class="token comment">#文章顶部默认图片</span>  <span class="token key atrule">default_index_img</span><span class="token punctuation">:</span> /img/posts/default.webp <span class="token comment">#文章列表左侧默认图片</span><span class="token comment">#归档</span><span class="token key atrule">archive</span><span class="token punctuation">:</span>  <span class="token key atrule">banner_img</span><span class="token punctuation">:</span> /img/home.png<span class="token comment">#标签</span><span class="token key atrule">tag</span><span class="token punctuation">:</span>  <span class="token key atrule">banner_img</span><span class="token punctuation">:</span> /img/home.png<span class="token comment">#分类</span><span class="token key atrule">category</span><span class="token punctuation">:</span>  <span class="token key atrule">banner_img</span><span class="token punctuation">:</span> /img/home.png<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>其他的配置可以在<a href="https://hexo.fluid-dev.com/docs/guide/#%E5%85%B3%E4%BA%8E%E6%8C%87%E5%8D%97">这里</a>查看。</p><p>在说下可能要用到的工具</p><p><a href="https://github.com/chenzhutian/hexo-all-minifier">hexo-all-minifier</a>：这个是压缩js，css，html，图片的工具</p><p> 通过 <code>npm i hexo-all-minifier --save</code>安装，但是可能会安装失败，因为它的ip地址好像在国内屏蔽了，看了网上的可以去查询源地址的ip，加在windows的host文件中，有些麻烦，而且换台设备就又要重新配置host，即使配置完成也可能会install到linux环境的包，在windows环境下不能使用，又会报错，所以我推荐用安装cnpm，然后执行<code>cnpm i hexo-all-minifier --save</code></p><p>然后在博客配置下配置下就可以了</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment">#压缩资源</span><span class="token key atrule">all_minifier</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h4 id="4-完成"><a href="#4-完成" class="headerlink" title="4.完成"></a>4.完成</h4><p>完成上面步骤就可以运行<code>hexo s</code>来看看本地的执行效果，然后下面就是部署了</p><h2 id="部署到Github-pages上"><a href="#部署到Github-pages上" class="headerlink" title="部署到Github pages上"></a>部署到Github pages上</h2><p>建立在各位都有github账号的基础上，如果你还没有github账号，可以到<a href="https://github.com/">Github</a>上注册个账号，注册完之后还需要下载<code>Git</code>绑定用户数据和<code>SSH KEYS</code>，这里就不进行撰写了</p><h3 id="创建个人pages页面"><a href="#创建个人pages页面" class="headerlink" title="创建个人pages页面"></a>创建个人pages页面</h3><p>创建pages库，仓库名必须是<code>&lt;username&gt;.github.io</code>，因为我已经有这个仓库，所以报错了，没有的创建是不会有提示的，库的状态必须是<code>public</code>,可以创建或者不用创建<code>README.md</code>，之后自己想写的时候补充也行</p><p><img src="https://cdn.jsdelivr.net/gh/qiongxing/qiongxing.github.io@main/source/img/posts/2021/git-create-repo.png" alt="创建共有库"></p><p>然后在创建成功的仓库页面复制<code>SSH链接</code>，为什么不是<code>HTTPS</code>链接呢，因为Git对https的支持逐渐减弱，每次都要校验账户号密码会很麻烦。</p><p>不过SSH，也需要在电脑上创建一对密钥，将公钥配置到Github的<code>SSH keys</code>，但是好处就是一劳永逸</p><p><img src="https://cdn.jsdelivr.net/gh/qiongxing/qiongxing.github.io@main/source/img/posts/2021/git-ssh.png" alt="创建共有库"></p><p>将Hexo项目关联到Git仓库</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#先确定默认初始化分支为main，因为新的git已经没有master分支了，但是本地init的时候依旧是master，所以要改下默认分支git config --global init.defaultBranch main git initgit remote add origin &lt;复制的ssh地址&gt;git pull origin maingit add .git commit -m &quot;first blog commit&quot;git push origin main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>以上操作就将博客源数据与仓库绑定了，且上传到了github仓库，可以刷新下github地址，就可以看到上传的数据了</p><h2 id="使用Github-Action持续部署pages"><a href="#使用Github-Action持续部署pages" class="headerlink" title="使用Github Action持续部署pages"></a>使用Github Action持续部署pages</h2><p>首先我们需要创建一个分支用来存储我们部署后的地址，我创建的部署分支是<code>gh-pages</code>,也是别人访问<code>https://&lt;username&gt;.github.io</code>时的部署分支，当然也可以自己创建一个仓库来存储部署后的内容，不过如果创建一个仓库，那这个仓库一定要是<code>public</code>的</p><p>首先，生成我们需要用到的一对密钥，<strong>这一对密钥一定不要上传到git上</strong></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh-keygen -t rsa -b 4096 -C &quot;deploy key&quot; -f deploy-key -N &quot;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>执行上面步骤可以在执行目录下生成<code>deploy-key(私钥)</code>和<code>deploy-key(公钥)</code>，打开2个文件，里面存的就是一对加密的字符串了，本质是RSA的一种非对称加密。然后就是需要配置到仓库里面了</p><blockquote><p>打开博客的仓库，访问<code>Settings&gt;Secrets&gt;New repository secret</code>，name可以自己取，推荐用全大写，有标识性，然后将私钥里面的内容复制到Value里面。然后点击<code>Settings&gt;Deploy keys&gt;Add deploy key</code>，和公钥的内容复制到<code>Key</code>中,<code>Title</code>可以随便取，保存后，公钥可能要启用才能生效</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/qiongxing/qiongxing.github.io@main/source/img/posts/2021/crete-secrets.png" alt="创建密钥"></p><p>github action是根据项目根目录检测到<code>.github&gt;xxx.yml</code>的文件时，会在一个独立容器中执行执行里面的<code>yaml</code>语句。所以我们要在根目录下创建<code>.github</code>文件夹，和<code>deloy.yml</code>，名称可以随便取，单必须是<code>.yml</code>，且可以有多个，下面是我的配置信息</p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy GitHub Pages<span class="token comment"># 触发条件：在 push 到 main 分支后</span><span class="token key atrule">on</span><span class="token punctuation">:</span>  <span class="token key atrule">push</span><span class="token punctuation">:</span>    <span class="token key atrule">branches</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> main<span class="token comment"># 任务</span><span class="token key atrule">jobs</span><span class="token punctuation">:</span>  <span class="token key atrule">build-and-deploy</span><span class="token punctuation">:</span>    <span class="token comment"># 服务器环境：最新版 Ubuntu</span>    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest    <span class="token key atrule">steps</span><span class="token punctuation">:</span>      <span class="token comment"># 拉取代码</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout 🔔        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2        <span class="token key atrule">with</span><span class="token punctuation">:</span>          <span class="token key atrule">persist-credentials</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>      <span class="token comment"># 1、生成静态文件</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build ⏳        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install <span class="token important">&amp;&amp;</span> npm run build      <span class="token comment"># 2、部署到 GitHub Pages</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy 🚀        <span class="token key atrule">uses</span><span class="token punctuation">:</span> JamesIves/github<span class="token punctuation">-</span>pages<span class="token punctuation">-</span>deploy<span class="token punctuation">-</span>action@4.1.1        <span class="token key atrule">with</span><span class="token punctuation">:</span>          <span class="token key atrule">ssh-key</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.BLOG_PRIVATE_KEY <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment">#你保存在部署项目的私钥</span>          <span class="token comment"># repository-name: qiongxing/qiongxing.github.io #因为是当前项目直接部署，所以不需要指向其他分支，如果要在其他仓库部署就需要填写</span>          <span class="token key atrule">branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages <span class="token comment">#部署到的分支</span>          <span class="token key atrule">folder</span><span class="token punctuation">:</span> public <span class="token comment">#指定public文件部署到gh-pages</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>$&#123;&#123; secrets.BLOG_PRIVATE_KEY &#125;&#125;</code>会直接获取你在<code>Secrets</code>里面创建的私钥，因为我执行的是<code>npm run build</code>，所以会在根目录生成一个public文件目录,public就是我们生成的静态部署博客了，然后将public提交到指定分支就可以了</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"clean"</span><span class="token operator">:</span> <span class="token string">"hexo clean"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"npm run clean &amp;&amp; hexo generate"</span><span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="设置pages的Source"><a href="#设置pages的Source" class="headerlink" title="设置pages的Source"></a>设置pages的Source</h3><p>这步很简单，在<code>Settings&gt;Pages&gt;Source</code>指定部署的分支就可以了，有域名的也可以<code>Custom domain</code>指定域名，并且域名解析配置到<code>&lt;username&gt;.github.io</code>就行</p><p><img src="https://cdn.jsdelivr.net/gh/qiongxing/qiongxing.github.io@main/source/img/posts/2021/set-pages.png" alt="创建密钥"></p>]]></content>
    
    
    <categories>
      
      <category>其他技术</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
